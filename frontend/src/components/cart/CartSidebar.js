import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { ArrowRight, Minus, Plus, ShoppingBag, Star, Trash2, X } from 'lucide-react';
import { useNavigate } from 'react-router-dom';
import { formatPrice } from '../../utils/utils';
import { ImageWithFallback } from '../figma/ImageWithFallback';
import { Badge } from '../ui/badge';
import { Button } from '../ui/button';
import { Checkbox } from '../ui/checkbox';
import { ScrollArea } from '../ui/scroll-area';
import { Separator } from '../ui/separator';
import { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle } from '../ui/sheet';
export function CartSidebar({ isOpen, onClose, items, onUpdateQuantity, onRemoveItem, onToggleSelectItem, onSelectAllItems, onDeselectAllItems, selectedTotalPrice, selectedItems, onCheckout }) {
    const navigate = useNavigate();
    const totalItems = items.reduce((sum, item) => sum + item.quantity, 0);
    const selectedItemsCount = selectedItems.reduce((sum, item) => sum + item.quantity, 0);
    const allSelected = items.length > 0 && items.every(item => item.selected);
    const someSelected = items.some(item => item.selected);
    const shippingFee = selectedTotalPrice >= 1000000 ? 0 : 30000;
    const discount = selectedTotalPrice >= 2000000 ? selectedTotalPrice * 0.05 : 0;
    const finalTotal = selectedTotalPrice + shippingFee - discount;
    const handleCheckout = () => {
        if (selectedItems.length === 0) {
            return;
        }
        onClose();
        navigate('/checkout', {
            state: {
                items: selectedItems,
            },
        });
    };
    return (_jsx(Sheet, { open: isOpen, onOpenChange: (open) => {
            if (!open) {
                onClose();
            }
        }, children: _jsxs(SheetContent, { className: "w-full sm:w-[480px] flex flex-col p-0 overflow-hidden", children: [_jsxs("div", { className: "px-6 py-4 border-b border-border bg-card relative", children: [_jsx(Button, { variant: "ghost", size: "sm", onClick: onClose, className: "absolute top-4 right-4 w-8 h-8 p-0 rounded-full z-20", children: _jsx(X, { className: "w-4 h-4" }) }), _jsx(SheetHeader, { children: _jsxs(SheetTitle, { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-10 h-10 bg-gradient-to-br from-primary to-primary/80 rounded-full flex items-center justify-center", children: _jsx(ShoppingBag, { className: "w-5 h-5 text-primary-foreground" }) }), _jsxs("div", { children: [_jsx("h2", { children: "Gi\u1ECF h\u00E0ng" }), _jsx(SheetDescription, { children: items.length > 0 ? `${items.length} sản phẩm` : 'Chưa có sản phẩm nào' })] })] }), items.length > 0 && (_jsx(Badge, { variant: "secondary", className: "bg-primary/10 text-primary", children: totalItems }))] }) })] }), items.length === 0 ? (_jsxs("div", { className: "flex-1 flex flex-col items-center justify-center space-y-6 px-6", children: [_jsx("div", { className: "w-32 h-32 bg-gradient-to-br from-primary/10 to-primary/5 rounded-full flex items-center justify-center", children: _jsx(ShoppingBag, { className: "w-16 h-16 text-primary/60" }) }), _jsxs("div", { className: "text-center space-y-2", children: [_jsx("h3", { className: "text-lg font-semibold", children: "Gi\u1ECF h\u00E0ng tr\u1ED1ng" }), _jsx("p", { className: "text-muted-foreground text-sm max-w-[280px]", children: "Kh\u00E1m ph\u00E1 h\u00E0ng ng\u00E0n s\u1EA3n ph\u1EA9m ch\u1EA5t l\u01B0\u1EE3ng v\u00E0 th\u00EAm v\u00E0o gi\u1ECF h\u00E0ng c\u1EE7a b\u1EA1n" })] }), _jsx(Button, { onClick: onClose, className: "px-8", children: "Kh\u00E1m ph\u00E1 s\u1EA3n ph\u1EA9m" })] })) : (_jsxs(_Fragment, { children: [_jsx("div", { className: "px-6 py-3 border-b border-border bg-muted/20", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx(Checkbox, { checked: allSelected, onCheckedChange: () => allSelected ? onDeselectAllItems() : onSelectAllItems(), className: "data-[state=checked]:bg-primary data-[state=checked]:border-primary" }), _jsxs("span", { className: "text-sm font-medium", children: ["Ch\u1ECDn t\u1EA5t c\u1EA3 (", items.length, " s\u1EA3n ph\u1EA9m)"] }), someSelected && !allSelected && (_jsxs(Badge, { variant: "secondary", className: "text-xs", children: [selectedItems.length, " \u0111\u00E3 ch\u1ECDn"] }))] }) }), _jsx(ScrollArea, { className: "flex-1 overflow-auto", style: { maxHeight: 'calc(100vh - 380px)' }, children: _jsx("div", { className: "px-6", children: _jsx("div", { className: "space-y-4 py-4", children: items.map((item) => (_jsxs("div", { className: `group relative bg-card border rounded-xl p-4 transition-all duration-200 hover:shadow-md ${item.selected ? 'border-primary bg-primary/5' : 'border-border hover:border-primary/20'}`, children: [item.isSale && (_jsx(Badge, { className: "absolute -top-2 -right-2 bg-destructive text-destructive-foreground z-10", children: "SALE" })), _jsxs("div", { className: "flex gap-4", children: [_jsx("div", { className: "flex items-start pt-1", children: _jsx(Checkbox, { checked: item.selected || false, onCheckedChange: () => onToggleSelectItem(item.id), className: "data-[state=checked]:bg-primary data-[state=checked]:border-primary" }) }), _jsx("div", { className: "relative w-20 h-20 bg-muted/20 rounded-xl overflow-hidden flex-shrink-0", children: _jsx(ImageWithFallback, { src: item.image, alt: item.name, className: "w-full h-full object-cover transition-transform duration-200 group-hover:scale-105" }) }), _jsxs("div", { className: "flex-1 space-y-3", children: [_jsxs("div", { className: "flex items-start justify-between gap-2", children: [_jsxs("div", { className: "flex-1", children: [_jsx("h4", { className: "font-semibold text-sm leading-tight line-clamp-2", children: item.name }), _jsxs("div", { className: "flex items-center gap-1 mt-1", children: [_jsx(Star, { className: "w-3 h-3 text-yellow-500 fill-current" }), _jsxs("span", { className: "text-xs text-muted-foreground", children: [item.rating, " (", item.reviews, ")"] })] })] }), _jsx(Button, { variant: "ghost", size: "sm", onClick: () => onRemoveItem(item.id), className: "text-muted-foreground hover:text-destructive h-8 w-8 p-0", children: _jsx(Trash2, { className: "w-4 h-4" }) })] }), _jsxs("div", { className: "flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center gap-2 bg-muted/50 rounded-lg p-1", children: [_jsx(Button, { variant: "ghost", size: "sm", onClick: () => onUpdateQuantity(item.id, item.quantity - 1), disabled: item.quantity <= 1, className: "h-7 w-7 p-0", children: _jsx(Minus, { className: "w-3 h-3" }) }), _jsx("span", { className: "w-8 text-center text-sm font-medium", children: item.quantity }), _jsx(Button, { variant: "ghost", size: "sm", onClick: () => onUpdateQuantity(item.id, item.quantity + 1), className: "h-7 w-7 p-0", children: _jsx(Plus, { className: "w-3 h-3" }) })] }), _jsxs("div", { className: "text-right", children: [_jsx("div", { className: "font-semibold text-sm", children: formatPrice(item.price * item.quantity) }), item.originalPrice && (_jsx("div", { className: "text-xs text-muted-foreground line-through", children: formatPrice(item.originalPrice * item.quantity) }))] })] })] })] })] }, item.id))) }) }) }), _jsxs("div", { className: "bg-muted/30 border-t border-border p-3 space-y-2 text-sm", children: [_jsx("div", { className: "grid grid-cols-2 gap-3" }), _jsxs("div", { className: "space-y-3", children: [_jsxs("div", { className: "flex justify-between text-sm", children: [_jsxs("span", { children: ["T\u1EA1m t\u00EDnh (", selectedItemsCount, " s\u1EA3n ph\u1EA9m \u0111\u00E3 ch\u1ECDn)"] }), _jsx("span", { children: formatPrice(selectedTotalPrice) })] }), _jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { children: "Ph\u00ED v\u1EADn chuy\u1EC3n" }), _jsx("span", { className: shippingFee === 0 ? "text-green-600 font-medium" : "", children: shippingFee === 0 ? "Miễn phí" : formatPrice(shippingFee) })] }), discount > 0 && (_jsxs("div", { className: "flex justify-between text-sm text-green-600", children: [_jsx("span", { children: "Gi\u1EA3m gi\u00E1 (5%)" }), _jsxs("span", { children: ["-", formatPrice(discount)] })] })), _jsx(Separator, {}), _jsxs("div", { className: "flex justify-between font-semibold", children: [_jsx("span", { children: "T\u1ED5ng c\u1ED9ng" }), _jsx("span", { className: "text-lg text-primary", children: formatPrice(finalTotal) })] })] }), _jsxs("div", { className: "space-y-3", children: [_jsx(Button, { className: "w-full h-10 text-sm gap-2", onClick: handleCheckout, disabled: selectedItems.length === 0, children: _jsxs("div", { className: "flex items-center justify-between w-full", children: [_jsxs("span", { className: "flex items-center gap-2", children: ["Mua h\u00E0ng (", selectedItems.length, ")"] }), _jsxs("span", { className: "flex items-center gap-1", children: [formatPrice(finalTotal), _jsx(ArrowRight, { className: "w-4 h-4" })] })] }) }), _jsx(Button, { variant: "outline", className: "w-full h-9 text-xs", onClick: onClose, children: "Ti\u1EBFp t\u1EE5c mua s\u1EAFm" })] })] })] }))] }) }));
}
